# AWS설정
## AWS EC2 구축 
1. EC2 인스턴스 생성
2. 이후 탄력적 IP 생성 이후 이를 생성한 EC2 인스턴스에 설정한다.
3. EC2 인스턴스를 생성하면서 다운로드 받은 pem파일을 `~/.ssh/`폴더로 옮긴다.
4. 이후 pem키의 권한을 변경한다.
    - `chmod 600 ~/.ssh/server.key`
5. `~/.ssh`디렉토리에 vim을 활용해서 config파일을 생성한 다음 이를 작성한다.
```
Host server
        HostName xxx.xxx.xxx.xx
        User ec2-user
        IdentityFile ~/.ssh/server.pem
```
6. `ssh server`명령어를 통해 접속할 수 있게 된다.
7. 해당 명령어를 통해 인스턴스에 접속한 다음 java 11을 설치한다.
    - `sudo yum install java-11-amazon-corretto`명령어를 입력한다.
    - `java -version`으로 설치가 되었는지 확인한다.
8. 타임존을 한국으로 설정한다.   
    1. 아래의 명령어를 입력한다.
        ```sudo rm /etc/localtime
        sudo ln -s /usr/share/zoneinfo/Asia/Seoul /etc/localtime
        ``` 
    2. root 계정으로 변환 한 뒤 `/etc/sysconfig/clock`을 변경한다.
        ```
        # root 계정으로 변환
        sudo su - root
        # /etc/sysconfig/clock을 vim으로 연다.
        vim /etc/sysconfig/clock
        ```
        ```
        # vim을 이용해서 입력
        ZONE="Asia/Seoul"
        UTC=true
        ```
    3. `sudo reboot`를 통해서 재부팅 한 뒤, `date` 명령어를 통해서 타임존이 변경되었는지 확인한다.
9. Hostname 변경
    1. hostnamectl 명령으로 호스트 이름을 설정하여 원하는 시스템 호스트 이름을 반영한다.(예: server)
        ```
        sudo hostnamectl set-hostname server.localdomain
        ```
    2. 선호하는 텍스트 편집기로 `/etc/hosts` 파일을 열고 127.0.0.1로 시작되는 항목을 아래 예제와 일치하도록 변경한다. 원하는 호스트 이름을 대신 입력하면 된다.
        ```
        127.0.0.1 server.localdomain server localhost4 localhost4.localdomain4
        ```
    3. 인스턴스를 재부팅하여 새 호스트 이름을 적용한다.
        ```
        sudo reboot
        ```
    4. 인스턴스에 로그인하고 호스트 이름이 업데이트되었는지 확인한다. 프롬프트에 새 호스트 이름이 첫 번째 "."까지 표시되어야 하고, hostname 명령이 정규화된 도메인 이름을 표시해야 한다.
        ```
        [ec2-user@server ~]$ hostname
        server.localdomain
        ```
    5. `curl server`로 확인한다. 아래와 같이 뜨는지 확인한다.   
        ```
        [ec2-user@server ~]$ curl server
        curl: (7) Failed to connect to server port 80: Connection refused
        ```

> ## 참고자료
> 1. 스프링 부트와 AWS로 혼자 구현하는 웹 서비스
> 2. [아마존 리눅스 2용 Amazon Corretto 11 설치 지침](https://docs.aws.amazon.com/ko_kr/corretto/latest/corretto-11-ug/amazon-linux-install.html)
> 3. [Amazon Linux 인스턴스에서 호스트 이름 변경](https://docs.aws.amazon.com/ko_kr/AWSEC2/latest/UserGuide/set-hostname.html)